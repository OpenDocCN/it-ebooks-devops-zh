# è·¯ç”±å™¨æ€æ ·åˆ· OpenWrt å›ºä»¶ (WR2543N ä¸ºä¾‹)

# æ€æ ·åˆ·ç¬¬ä¸‰æ–¹è·¯ç”±å™¨å›ºä»¶ OpenWrt

ç»è¿‡å‰é¢çš„å‡†å¤‡ï¼Œç»ˆäºè¦ç»™äº²è‡ªç»™è·¯ç”±å™¨åˆ· OpenWrt å›ºä»¶äº†ã€‚æœ‰å¯èƒ½å¤±è´¥ï¼Œæœ‰å¯èƒ½æˆåŠŸã€‚ä¸€è¿å˜´é‡Œå¿µå¨ FGW (=fuck great wall),ä¸€è¾¹ç»™è‡ªå·±æ‰“æ°”ã€‚

æœ‰å‡ ä¸ªé—®é¢˜æœ‰å¿…è¦æä¸€ä¸‹ï¼š

## OpenWrt æœ‰å¿…è¦è£…ä¸­æ–‡ç®¡ç†ç•Œé¢å—?

æˆ‘è®¤ä¸ºä¸éœ€è¦ã€‚ç½‘ä¸Šæœ€æ–°æœ€å…¨é¢çš„ä¿¡æ¯éƒ½æ˜¯è‹±æ–‡çš„ã€‚GFW åœ¨ä¸æ–­è¿›æ­¥ï¼Œæˆ‘ä»¬ä¹Ÿè¦ä¸åœåœ°å­¦ä¹ ã€‚æˆ‘ä»¬è¦æ„Ÿè°¢ GFWï¼Œè®©æˆ‘ä»¬æ¯å¤©å¤šè®°å‡ ä¸ªå•è¯ã€‚ä¸€äº›æ­¥éª¤çš„æ“ä½œï¼Œæˆ‘ç‰¹æ„æˆªå›¾å¹¶åŠ ä¸Šäº†æ­¥éª¤æ ‡è¯†ï¼Œå®åœ¨è®°ä¸ä½å°±æ¯æ¬¡æ‰“å¼€è¿™ä¸ªæ•™ç¨‹ç…§ç€å›¾ç¤ºæ¥ã€‚

## åœ¨å¼€æºçš„ Linux ç±»æ“ä½œç³»ç»Ÿé‡Œè¿æ¥ OpenWrt è¿›è¡Œæ“ä½œ

æˆ‘è®¤ä¸ºæœ‰å¿…è¦ä»ç°åœ¨å¼€å§‹åˆ‡æ¢åˆ° Linux ç±»æ“ä½œç³»ç»Ÿäº†ã€‚Windows å·²ç»å¼€å§‹èµ°å‘æ²¡è½ï¼Œå¼€æºæ“ä½œç³»ç»Ÿæ¸æ¸èµ¶ä¸Šé—­æºå•†ä¸šæ“ä½œç³»ç»Ÿã€‚

ä¸ºä»€ä¹ˆå‘¢ï¼Ÿéšç€æŠ€æœ¯çš„ä¸æ–­è¿›åŒ–ï¼Œå¼€æºçš„æŠ€æœ¯åˆä½œè¶Šæ¥è¶Šæ–¹ä¾¿ã€‚æˆ‘æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœä½›æ•™è€å¤§é‡Šçˆç‰Ÿå°¼ï¼ŒåŸºç£æ•™åˆ›å§‹äººè€¶ç¨£ï¼Œä¸å¼€æºææ€•ä¹Ÿä¼šç©·é€”æœ«è·¯ã€‚

å†è¯´ OpenWrt å°±æ˜¯å¾®å‹çš„ Linux æ“ä½œç³»ç»Ÿï¼Œç†Ÿæ‚‰äº† Linuxï¼Œå­¦ä¹  OpenWrt å°±å¾ˆå®¹æ˜“äº†ã€‚

åœ¨ä»¥åçš„æ•™ç¨‹é‡Œï¼Œéƒ½æ˜¯åœ¨ Ubuntu ä¸‹å¯¹ OpenWrt è¿›è¡Œç®¡ç†ã€‚å¦‚æœæœ‰ä¸¤å°ç”µè„‘ï¼Œå»ºè®®ä¸€å°è£… Ubuntuï¼Œå¦‚æœåªæœ‰ä¸€å°ç”µè„‘ï¼Œå¯ä»¥è£… Ubuntu å’Œ Windows åŒå¯åŠ¨ã€‚

* * *

#### æœ€ç®€å•çš„è·¯ç”±å™¨åˆ· OpenWrt å›ºä»¶ğŸªœğŸ§±æ•™ç¨‹:

[`github.com/softwaredownload/openwrt-fanqiang`](https://github.com/softwaredownload/openwrt-fanqiang "æœ€ç®€å•çš„è·¯ç”±å™¨åˆ· OpenWrt å›ºä»¶ğŸªœğŸ§±æ•™ç¨‹")

#### åœ¨çº¿é˜…è¯» OpenWrt ğŸªœğŸ§±è·¯ç”±å™¨æ•™ç¨‹:

[`www.gitbook.com/book/softwaredownload/openwrt-fanqiang/details`](https://www.gitbook.com/book/softwaredownload/openwrt-fanqiang/details)

# æ€æ ·ä¸‹è½½ OpenWrt å›ºä»¶

# æ€æ ·ä¸‹è½½é€‚åˆè‡ªå·±è·¯ç”±å™¨çš„ OpenWrt å›ºä»¶

## ä¸‹è½½æœ€æ–°ç‰ˆçš„ OpenWRT å›ºä»¶

*   è¿›å…¥ OpenWrt å›ºä»¶ä¸‹è½½ä¸»é¡µé¢ï¼š

    [`downloads.openwrt.org/`](http://downloads.openwrt.org/)

    Binary Releasesy å°±æ˜¯æœ€åçš„ç¨³å®šå‘è¡Œç‰ˆï¼Œå¦‚ç›®å‰æ˜¯

    ```
     Chaos Calmer 15.05
      Released: Fri, 11 Sep 2015 
    ```

    Development Snapshots æ˜¯å¼€å‘ç‰ˆï¼ŒåŒ…å«æœ€æ–°çš„åŠŸèƒ½ï¼Œä½†å¯èƒ½ä¸å¤Ÿç¨³å®šã€‚

    [`downloads.openwrt.org/snapshots/trunk/`](http://downloads.openwrt.org/snapshots/trunk/)

    å¦‚æœä½¿ç”¨ Snapshots æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå½“ç„¶æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå¦åˆ™å¯ä»¥å°è¯•ä¸€ä¸‹ç¨³å®šå‘è¡Œç‰ˆã€‚

    ä¸‹é¢ä»¥ snapshotsï¼Œå’Œ WR2543 ä¸¾ä¾‹ã€‚

*   é€‰æ‹© CPU ç±»å‹

    æ‰“å¼€é¡µé¢åï¼Œé€‰æ‹©ä½ çš„è·¯ç”±å™¨çš„èŠ¯ç‰‡å‹å·è¿›å…¥ï¼Œå¾ˆå¤šæ˜¯ ar71xx ç³»åˆ—ï¼Œäºæ˜¯è¿›å…¥äº†ï¼š

    [`downloads.openwrt.org/snapshots/trunk/ar71xx/`](http://downloads.openwrt.org/snapshots/trunk/ar71xx/)

*   é€‰æ‹© Flash ç±»å‹

    å†é€‰æ‹© Flash ç±»å‹ï¼Œæ¯”å¦‚ WR2543 æ˜¯ genericï¼Œç½‘ä»¶ WNDR4300 è·¯ç”±å™¨æ˜¯ nandã€‚

    [`downloads.openwrt.org/snapshots/trunk/ar71xx/generic/`](http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/)

    å†é€‰æ‹©ä½ çš„è·¯ç”±å™¨å‹å·ï¼Œé¡µé¢æœç´¢ wr2543ï¼Œæ‰¾åˆ°äº†å—ã€‚æœ‰ä¸¤ä¸ªæ–‡å­—ä¾›ä¸‹è½½ï¼Œä¸€ä¸ªæ–‡ä»¶ç»“å°¾æ˜¯ factory.bin,é€‚åˆåŸå‚å›ºä»¶ä¸‹åˆ·ï¼Œå¦ä¸€ä¸ªæ–‡ä»¶åç»“å°¾æ˜¯ sysupgrade.bin,é€‚åˆå·²ç»æ˜¯ OpenWrt ç³»ç»Ÿä¸‹åˆ·ã€‚

## OpenWrt å®˜æ–¹ wiki ä¸‹è½½ OpenWrt å›ºä»¶ for WR2543

OpenWrt å®˜æ–¹ç½‘é¡µä¸Šæœ‰ WR2543N çš„ä¸“é¡µ,è¯¦ç»†ä»‹ç»äº†åˆ·æœºæ­¥éª¤åŠæ³¨æ„äº‹é¡¹.

æ‰“å¼€å®˜æ–¹ Wiki é¡µé¢ [TP-Link TL-WR2543ND](http://wiki.openwrt.org/toh/tp-link/tl-wr2543nd)

ä¸Šé¢åˆ—å‡ºäº†æ”¯æŒçš„ç‰ˆæœ¬: v1.0 å’Œ v1.2ã€‚æˆ‘çš„è·¯ç”±å™¨æ˜¯ v1.0 çš„ï¼Œå¯ä»¥åˆ·ï¼Œä½ çš„ç‰ˆæœ¬å¦‚æœä¸æ˜¯è¿™ä¸¤ä¸ªï¼Œä¸èƒ½ç¡®ä¿èƒ½åˆ·æˆåŠŸã€‚

è¿™ä¸¤ä¸ªå›ºä»¶éƒ½å¸¦ LuCI ç½‘é¡µç®¡ç†ç•Œé¢ã€‚æœ‰æ—¶å€™ï¼Œå¦‚æœä½ å‡çº§äº†ä¸å¸¦ LuCI çš„å›ºä»¶ï¼Œå‘½ä»¤è¡Œæ–¹å¼åˆæ— æ³•æå®š OpenWRT ä¸Šç½‘å‚æ•°è®¾ç½®,å°±éœ€è¦å…ˆåœ¨ç”µè„‘é‡Œä¸‹è½½å¸¦ LuCI çš„å›ºä»¶ï¼Œscp å¤åˆ¶åˆ°è·¯ç”±å™¨å‡çº§ï¼Œå†é€šè¿‡ç½‘é¡µè®¾ç½®ã€‚

æœ‰ä¸¤ä¸ªå›ºä»¶ä¾›ä¸‹è½½:

*   [openwrt-ar71xx-generic-tl-wr2543n-v1-squashfs-factory.bin](http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-factory.bin) - Installing OpenWRT from factory

*   [openwrt-ar71xx-generic-tl-wr2543n-v1-squashfs-sysupgrade.bin](http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin) - Upgrading an existing OpenWRT install

ä¸€å®šè¦æ³¨æ„:

*   åœ¨åŸå‚å›ºä»¶ä¸Šåˆ· OpenWrt, è¦ç”¨å›ºä»¶æ–‡ä»¶åå¸¦ **factory** çš„.bin æ–‡ä»¶.
*   å·²ç»åˆ·äº† OpenWrt å›ºä»¶, å†å‡çº§ OpenWrt å›ºä»¶æ—¶å°±è¦ç”¨æ–‡ä»¶åå¸¦ **sysupgrade** çš„ .bin æ–‡ä»¶.

ç°åœ¨æˆ‘ä»¬æ˜¯åœ¨åŸå‚å›ºä»¶åŸºç¡€ä¸Šåˆ· OpenWrt, è‡ªç„¶æ˜¯ä¸‹è½½ç¬¬ä¸€ä¸ªæ–‡ä»¶,ä¹Ÿå°±æ˜¯ openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-factory.bin

è¦ç¡®ä¿ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶å®Œæ•´,ä¸‹è½½è¿‡ç¨‹æ²¡æœ‰ä¸­æ–­,å¦‚æœä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶ä¸å®Œæ•´,å¹¶æŠŠè¿™ä¸ªä¸å®Œæ•´çš„æ–‡ä»¶åˆ·è¿›æœºå™¨,æ¢å¤èµ·æ¥å¾ˆéº»çƒ¦,æœ‰å¯èƒ½å˜ç –.

### ä¸‹è½½é¢„ç¼–è¯‘çš„ğŸªœğŸ§±å›ºä»¶ for WR2543

*   [`software-download.name/2014/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade-bin-with-shadowsocks/`](https://software-download.name/2014/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade-bin-with-shadowsocks/)

# ç½‘é¡µç•Œé¢åˆ· OpenWrt æ•™ç¨‹

# é€šè¿‡ç½‘é¡µç•Œé¢ WR2543 åˆ· OpenWrt æ•™ç¨‹

## é€šè¿‡æœ‰çº¿æˆ–æ— çº¿è¿ä¸Š WR2543 è·¯ç”±å™¨

## æ‰“å¼€æµè§ˆå™¨,è¾“å…¥è·¯ç”±å™¨çš„ IP åœ°å€: [192.168.1.1](http://192.168.1.1)

å›è½¦,åœ¨å¯†ç éªŒè¯æ¡†,è¾“å…¥ç”¨æˆ·å: **admin** å¯†ç ä¹Ÿæ˜¯ **admin**

## è·¯ç”±å™¨å›ºä»¶å‡çº§

é€‰æ‹©èœå•ç³»ç»Ÿå·¥å…·â†’ è½¯ä»¶å‡çº§
![](img/2.2.factory-upgrade.png)

ç‚¹å‡» **æµè§ˆ** æŒ‰é’®é€‰æ‹©ä¸‹è½½çš„æ–‡ä»¶ **openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-factory.bin**

æ³¨æ„ï¼Œæ–‡ä»¶åå¿…é¡»æ˜¯...factory.binã€‚

å†å•å‡» **å‡çº§** è¿›è¡Œè½¯ä»¶å‡çº§ã€‚è¦æ³¨æ„ï¼Œåœ¨åˆ·å›ºä»¶è¿‡ç¨‹ä¸­ä¸å¯åœç”µæˆ–å…¶ä»–åŸå› é€ æˆä¸­æ–­ï¼Œå¦åˆ™è·¯ç”±å™¨å°±å˜ç –äº†ã€‚

ç­‰å¾…å‡ åˆ†é’Ÿ

ç­‰é”å½¢çš„æŒ‡ç¤ºç¯ä¸é—ªäº†ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥åœ°å€: [192.168.1.1](http://192.168.1.1) å›è½¦,å¦‚æœæ­£å¸¸çš„è¯,å°±è¿›å…¥äº† OpenWrt çš„ LuCI ç½‘é¡µç®¡ç†ç•Œé¢äº†. ![](img/2.2.luci-login.png)

é»˜è®¤ç”¨æˆ·åæ˜¯ root,é»˜è®¤å¯†ç æ˜¯ç©ºã€‚ç‚¹ **Login** ç›´æ¥ç™»å½•ã€‚

# ç½‘é¡µç•Œé¢ OpenWrt æ‹¨å·ä¸Šç½‘è®¾ç½®æ•™ç¨‹

è§é¢ç•Œé¢ç™»å½•è·¯ç”±å™¨åï¼Œå°±å¯ä»¥è®¾ç½®ä¸Šç½‘å‚æ•°äº†ã€‚

## ç¼–è¾‘ OpenWrt WAN è®¾ç½®

é€‰æ‹©ä¸Šé¢çš„ Networkï¼Œåœ¨ Interface é‡Œï¼ŒWAN å³è¾¹ï¼Œé€‰æ‹© Editã€‚WAN å’Œ ADSLã€€moderm ç›¸è¿ï¼Œè®¾ç½®æ‹¨å·ä¸Šç½‘è‡ªç„¶æ˜¯åœ¨ WAN è€Œä¸æ˜¯ LAN.

![](img/2.3.wan-edit.png)

## é…ç½® OpenWrt æ‹¨å·ä¸Šç½‘å¯†ç 

è¿›å»åï¼Œåœ¨åè®® Protocol ä¸‹æ‹‰åˆ—æ¡†é‡Œï¼Œé€‰æ‹©æ‹¨å·ä¸Šç½‘çš„åè®®ï¼Œä¹Ÿå°±æ˜¯ PPPoE, å†ç‚¹å‡»ä¸‹é¢çš„ Switch Protocol åˆ‡æ¢åè®®ã€‚

![](img/2.3.pppoe-switch.png)

## OpenWrt æ‹¨å·ä¸Šç½‘ç”¨æˆ·åå¯†ç è®¾ç½®

1.  PAP/CHAP username: æ‹¨å·ä¸Šç½‘ç”¨æˆ·å
2.  PAP/CHAP password:ã€€æ‹¨å·ä¸Šç½‘å¯†ç 
3.  ç‚¹å‡» **Save & Apply** ä¿å­˜å¹¶åº”ç”¨è®¾ç½®

![](img/2.3.pppoe-username-password.png)

è¿™æ—¶ï¼Œè¿æ¥ LAN çš„ç”µè„‘åº”è¯¥å·²ç»å¯ä»¥ä¸Šç½‘äº†ï¼Œä½†æ— çº¿è®¾å¤‡è¿˜ä¸è¡Œã€‚

# ç½‘é¡µç•Œé¢ OpenWrt æ— çº¿(Wifi)è®¾ç½®å›¾æ–‡æ•™ç¨‹

ç™»å½• OpenWrt è·¯ç”±å™¨åï¼š

## é€‰æ‹© Network, Wifi, Edit

![](img/2.4.wifi-edit.png)

## ç‚¹å‡» Enable æŒ‰é’®ï¼Œè¿™æ—¶æ— çº¿è®¾å¤‡å·²ç»å¯ä»¥è¿ä¸Š Wifi

![](img/2.4.wifi-enable.png)

é»˜è®¤ ESSID å°±æ˜¯ OpenWrtï¼Œæ²¡æœ‰å¯†ç ã€‚ä¸æƒ³åšæ´»é›·é”‹çš„åŠ ä¸ªå¯†ç å§ã€‚

## OpenWrt Wifi å¯†ç è®¾ç½®

æŠŠ ESSID æ”¹æˆ eastking-wr2543,ç„¶åï¼š

*   ç‚¹å‡» Wireless Security è¿›å…¥ OpenWrt æ— çº¿å®‰å…¨è®¾ç½®
*   Encryption åŠ å¯†æ–¹å¼ï¼ŒWPA2-PSK
*   Key å¯†ç ï¼škillgfw
*   Save & Applyã€€ä¿å­˜å¹¶åº”ç”¨è®¾ç½®

![](img/2.4.wifi-security.png)

è¿™æ—¶ï¼Œæ‰€æœ‰æ— çº¿è®¾å¤‡éƒ½å¯ä»¥é€šè¿‡ OpenWrt è·¯ç”±å™¨ä¸Šç½‘äº†ã€‚

## OpenWrt ç®¡ç†ç•Œé¢ç™»å½•å¯†ç è®¾ç½®

ä½ æ³¨æ„åˆ°æ²¡æœ‰ï¼Œ ç½‘é¡µä¸Šæ–¹æœ‰ä¸€ä¸ªçº¢è‰²çš„æ¡†æ¡†(No password set!)ä¸€ç›´åœ¨æç¤ºæˆ‘ä»¬ï¼š **å°äººä¸å¾—ä¸é˜²ï¼ŒOpenWrt å«ä½ è®¾ä¸€ä¸ªè·¯ç”±å™¨ç®¡ç†ç•Œé¢ç™»å½•å¯†ç å‘¢!**

1.  ç‚¹å‡»æœ€ä¸Šé¢çš„ System è¿›å…¥ç³»ç»Ÿè®¾ç½®
2.  å†ç‚¹å‡» Administration è¿›å…¥ç®¡ç†å‘˜è®¾ç½®
3.  å¯†ç  Password: fanqiang
4.  ç¡®è®¤å¯†ç  Confirmation: fanqiang
    ![](img/2.4.admin-password.png)
5.  å…¶ä»–è®¾ç½®ï¼šä¸‹é¢çš„ï¼š Gateway portsï¼Œå‹¾é€‰ **Allow remote hosts to connect to local SSH forwarded ports**ï¼ˆå…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ° SSH è½¬å‘ç«¯å£ï¼‰,è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨ SSH å‘½ä»¤è¡Œçš„æ–¹å¼ç®¡ç†è·¯ç”±å™¨ã€‚æœ€åç‚¹å‡»å³ä¸‹è§’ Save & Apply ä¿å­˜å¹¶åº”ç”¨è®¾ç½®ã€‚

# ç½‘é¡µç•Œé¢æ€æ ·å¤‡ä»½ OpenWrt è®¾ç½®

ç°åœ¨æœ‰çº¿å’Œæ— çº¿ä¸Šç½‘éƒ½æ­£å¸¸äº†ã€‚åº”è¯¥æŠŠç°æœ‰çš„ OpenWrt è®¾ç½®å¤‡ä»½ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜è¦ç»å¸¸æŠ˜è…¾ OpenWrtï¼Œæœ‰æ—¶ä¸€ä¸ªè®¾ç½®é”™è¯¯ï¼Œå¯èƒ½å°±ä¸Šä¸äº†ç½‘ï¼Œæœ‰äº†å¤‡ä»½ï¼Œå°±å¯ä»¥å¿«é€Ÿæ¢å¤ã€‚

### é€‰æ‹© System ç³»ç»Ÿè®¾ç½®

### é€‰æ‹© Backup / Flash Firmware å¤‡ä»½æ¢å¤å›ºä»¶

### Actions åŠ¨ä½œ

### Generate ç”Ÿæˆå¤‡ä»½æ–‡ä»¶å¹¶ä¿å­˜åˆ°ç”µè„‘

### å¦‚æœä»¥åä½ è¦æ¢å¤å¤‡ä»½ï¼Œå°±ç‚¹å‡» Browse...æµè§ˆå¹¶é€‰æ‹©å…ˆå‰å¤‡ä»½çš„æ–‡ä»¶æ¥æ¢å¤

![](img/2.5.backup-config.png)

# ç½‘é¡µç•Œé¢å‡çº§ OpenWrt å›ºä»¶

# é€šè¿‡ LuCI ç½‘é¡µç•Œé¢å‡çº§ OpenWrt å›ºä»¶

æˆ‘ä»¬ç°åœ¨å·²ç»ç»™ TP-Link WR2543N åˆ·ä¸Šäº† OpenWrt å›ºä»¶ï¼Œå¹¶ä¸”å¯ä»¥æ­£å¸¸ä¸Šç½‘äº†ã€‚å¦‚æœè¦å‡çº§ OpenWrt å›ºä»¶ï¼Œåˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

æœ‰ä¸¤ä¸ªé€”å¾„å‡çº§å›ºä»¶ï¼š

*   LuCI web ç•Œé¢å‡çº§
*   SSH å‘½ä»¤è¡Œç™»å½•è·¯ç”±å™¨å‡çº§

æœ¬èŠ‚å°±è®² web ç•Œé¢å‡çº§å›ºä»¶çš„æ–¹æ³•ã€‚

## ä¸‹è½½ OpenWrt å‡çº§ç”¨å›ºä»¶ sysupgrade.bin

ä¸‹è½½ç”¨äº WR2543N è·¯ç”±å™¨çš„å‡çº§å›ºä»¶ï¼Œå‡çº§ç”¨å›ºä»¶æ–‡ä»¶åä¸­æœ‰ sysupgrade å­—æ ·ã€‚

è¿˜æ˜¯åˆ° OpenWrt Wiki é¡µé¢ [TP-Link TL-WR2543ND](http://wiki.openwrt.org/toh/tp-link/tl-wr2543nd)

ç‚¹å‡» [openwrt-ar71xx-generic-tl-wr2543n-v1-squashfs-sysupgrade.bin](http://downloads.openwrt.org/attitude_adjustment/12.09/ar71xx/generic/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin) ä¸‹è½½ã€‚

å…¶å®è¿™ä¸ªå›ºä»¶çš„æ ¸å¿ƒå’Œæˆ‘ä»¬å…ˆå‰å®‰è£…çš„...factory.bin ä¸€æ ·ï¼Œæˆ‘ä»¬æ˜¯å‡ºäºå®éªŒç›®çš„ï¼Œæ¼”ç¤ºå‡çº§å›ºä»¶çš„æ–¹æ³•ï¼Œ

## ç”¨å‰æ–‡è®²è¿‡çš„æ–¹æ³•ä»ç½‘é¡µç™»å½• OpenWrt è·¯ç”±å™¨

## å¼€å§‹å‡çº§ OpenWrt å›ºä»¶

1.  System ç³»ç»Ÿ
2.  Backup / Flash Firmware å¤‡ä»½æˆ–åˆ·æ–°å›ºä»¶
3.  Flash new firmware, Browse...é€‰æ‹©æˆ‘ä»¬åˆšä¸‹è½½ä¸‹æ¥çš„å›ºä»¶
4.  Flash image...åˆ·æ–°å›ºä»¶
    æ³¨ï¼šå¦‚æœ Keep settings ä¿æŒå‹¾é€‰ï¼Œå‡çº§å›ºä»¶åï¼ŒåŸæ¥çš„è®¾ç½®å°±ä¼šä¿ç•™ï¼Œä¸ç”¨é‡æ–°è®¾ç½®æ‹¨å·ä¸Šç½‘å‚æ•°ã€‚
    ![](img/2.6.luci-sysupgrade.png)

# æ€æ ·è¿›å…¥ OpenWrt å®‰å…¨æ¢å¤æ¨¡å¼(WR2543N ä¸ºä¾‹)

æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½æ“ä½œå¤±è¯¯ï¼Œæ— æ³•è¿›å…¥ LuCI ç½‘é¡µç•Œé¢ç®¡ç†æ¢å¤å›ºä»¶ï¼Œè¿™æ—¶å°±éœ€è¦è¿›å…¥å®‰å…¨æ¨¡å¼æ¥æ¢å¤äº†ã€‚

ä¸åŒçš„è·¯ç”±å™¨ï¼Œè¿›å…¥å®‰å…¨æ¨¡å¼çš„æ–¹æ³•å¯èƒ½æœ‰æ‰€å·®åˆ«ï¼Œæœ¬æ–‡ç³»åˆ—é€‚ç”¨äº TP-LINK WR2543Nã€‚

å®‰å…¨æ¨¡å¼æ˜¯ç© OpenWrt çš„æ•‘å‘½ä»™ä¸¹ã€‚èƒ½ç†Ÿç»ƒè¿›å…¥å®‰å…¨æ¨¡å¼æ¥æ¢å¤è®¾ç½®ï¼Œæ˜¯ OpenWrt å·²ç»ä¸Šæ‰‹çš„ä¸€ä¸ªæ ‡å¿—ã€‚

è¿›å…¥å®‰å…¨æ¨¡å¼æ—¶ï¼Œæ²¡æœ‰æ— çº¿è¿æ¥å¯ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœ‰çº¿çš„æ–¹å¼ç™»å½• OpenWrtã€‚OpenWrt é»˜è®¤çš„ IP åœ°å€æ˜¯ 192.168.1.1ï¼Œæˆ‘ä»¬è¦è®¾ç½®ç”µè„‘æœ‰çº¿è¿æ¥çš„ IP åœ°å€ç±»ä¼¼äº 192.168.1.x, å…¶ä¸­ x æ˜¯ 2 è‡³ 255 çš„æ•°å­—ã€‚

WR2543N æ— çº¿è·¯ç”±å™¨è¿›å…¥ OpenWrt å®‰å…¨æ¨¡å¼çš„æ–¹æ³•ï¼š

1.  ç”¨ç½‘çº¿æŠŠè·¯ç”±å™¨å’Œç”µè„‘è¿æ¥èµ·æ¥ï¼Œè®¾ç½®ç”µè„‘ç½‘å¡çš„ IPv4 åœ°å€

    ä»¥ Ubuntu ä¸ºä¾‹ï¼Œç‚¹å‡»æ¡Œé¢å³ä¸Šè§’è¿æ¥ç¬¦å·ï¼Œé€‰æ‹© **Edit Connections**, å†é€‰æ‹© Ethernet è¿æ¥ï¼Œç‚¹å‡»ã€€Edit æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹© IPv4 Settings, Method é€‰æ‹© Manualï¼ŒAddress æ ç‚¹å‡» Addï¼Œè®¾ç½®å¦‚ä¸‹ï¼š

    *   Address: 192.168.1.90
    *   Netmask: 255.255.255.0
    *   Gateway: 192.168.1.1

        ![](img/2.7.editing-wired-connection.png)

2.  åœ¨ Ubuntu è¿è¡Œå‘½ä»¤ï¼š

    ```
     sudo tcpdump -Ani eth0 port 4919 and udp 
    ```

3.  é‡å¯è·¯ç”±å™¨,å½“ WR2543N çš„é”å½¢æŒ‡ç¤ºç¯åˆšä¸€å¼€å§‹é—ªçƒæ—¶ï¼Œç«‹å³æŒ‰è·¯ç”±å™¨èƒŒé¢çš„ wps æŒ‰é’® 3 æ¬¡

4.  Ubuntu å‘½ä»¤è¡Œç•Œé¢å‡ºç°ï¼š

    > Please press button now to enter failsafe

    ![](img/2.7.enter-failsafe.png)

5.  Ubuntu å‘½ä»¤è¡Œæ‰§è¡Œ(æœ‰æ—¶å¯ä»¥ä¸éœ€ tcpdump ç›´æ¥ telnet)ï¼š

    ```
     telnet 192.168.1.1 
    ```

    è¿™æ—¶å°±æˆåŠŸç™»å½•äº† OpenWrtï¼Œå¦‚ä¸‹å›¾:
    ![](img/2.7.busybox.png)

1.  è®¾ç½®ç™»å½• OpenWrt SSH ç™»å½•å¯†ç :

    ```
     passwd
     #è¾“å…¥å¯†ç  fanqiang 
    ```

    å¦‚æœå‡ºç°ï¼š

    ```
     passwd: /etc/passwd: Read-only file system
     passwd: can't update passwd file /etc/passwd 
    ```

    å°±è¾“å…¥ `mount_root` å†é‡æ–° passwd è®¾ç½®ç®¡ç†å‘˜å¯†ç ã€‚å¦‚ä¸‹å›¾ï¼š
    ![](img/2.7.passwd.png)

telnet ç™»å½•è·¯ç”±å™¨åï¼Œå¯ä»¥ç”¨ vi å‘½ä»¤ä¿®æ”¹è®¾ç½®ã€‚

è¿™æ—¶å¦‚æœä½ è¯•å›¾ç”¨æµè§ˆå™¨ç™»å½• 192.168.1.1 è¿›å…¥ç®¡ç†ç•Œé¢çš„è¯ï¼Œå¯èƒ½å¤±è´¥ã€‚

é‡å¯è·¯ç”±å™¨ï¼Œè·¯ç”±å™¨é”å½¢æŒ‡ç¤ºç¯å…ˆæ˜¯æ…¢é—ªï¼Œåˆ°å˜æˆå¸¸äº®æ—¶ï¼Œä½ åˆå¯ä»¥ç™»å½• 192.168.1.1 ç®¡ç†ç•Œé¢ã€‚ä¸€åˆ‡æ¢å¤æ­£å¸¸ã€‚

# å‘½ä»¤è¡Œ OpenWrt sysupgrade æ›´æ–°å›ºä»¶

# OpenWrt sysupgrade å‘½ä»¤è¡Œæ›´æ–°å›ºä»¶åˆ°æœ€æ–°ç‰ˆ

ä¸‹é¢æˆ‘ä»¬è¦ä½¿ç”¨ sysupgrade æ›´æ–°å›ºä»¶åˆ° snapshot æœ€æ–°ç‰ˆã€‚

è¦æ³¨æ„çš„æ˜¯ï¼Œtrunk åŒ…å«è¯•éªŒçš„åŠŸèƒ½ï¼Œå¯èƒ½ä¸ç¨³å®šï¼Œåˆ·æœºé£é™©è‡ªå·±æ‰¿æ‹…ã€‚

åœ¨æµè§ˆå™¨é‡Œç™»å½• 192.168.1.1 è¿›è¡Œå›ºä»¶å‡çº§æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ä»Šå¤©æˆ‘ä»¬è¦å°è¯•çš„çš„æ˜¯å‘½ä»¤è¡Œåˆ·æœºå‡çº§ã€‚å‘½ä»¤è¡Œçš„æ–¹å¼æ›´å¼ºå¤§ã€‚

## SSH ç™»å½•è·¯ç”±å™¨

åœ¨ Ubuntu é‡Œï¼ŒæŒ‰ Ctrl+Alt+T æ‰“å¼€å‘½ä»¤è¡Œç»ˆç«¯ï¼Œè¾“å…¥ï¼š

```
ssh root@192.168.1.1 
```

è¾“å…¥å¯†ç ï¼Œç™»å½•æˆåŠŸã€‚

![openwrt ssh login](img/2.8.ssh-login.png)

## è¿›å…¥ OpenWrt /tmp ç›®å½•

```
cd /tmp 
```

## æ£€æŸ¥ OpenWrt è·¯ç”±å™¨æ˜¯å¦æœ‰è¶³å¤Ÿçš„å†…å­˜

```
df -h 
```

å¯ä»¥çœ‹å‡ºï¼Œ **/tmp** è¿˜æœ‰ 29.5MB å¯ç”¨ç©ºé—´ï¼Œè€Œå‡çº§å›ºä»¶åœ¨ 3MB å·¦å³ï¼Œè¶³å¤Ÿäº†ã€‚
![check free RAM](img/2.8.free-ram.png)

## ä¸‹è½½ OpenWrt æœ€æ–° trunk ç‰ˆæœ¬å›ºä»¶

1.  åœ¨ Ubuntu é‡Œæµè§ˆå™¨æ‰“å¼€ [`downloads.openwrt.org/snapshots/trunk/`](http://downloads.openwrt.org/snapshots/trunk/)

2.  TP-LINK WR2543N è·¯ç”±å™¨çš„èŠ¯ç‰‡ç±»å‹æ˜¯ ar71xxï¼Œå°±ç‚¹å‡» [ar71xx](http://downloads.openwrt.org/snapshots/trunk/ar71xx/) ç›®å½•è¿›å…¥ã€‚è¦æ³¨æ„ï¼Œè·¯ç”±å™¨çš„èŠ¯ç‰‡ç±»å‹åƒä¸‡ä¸èƒ½æé”™ï¼Œä¸åŒè·¯ç”±å™¨å¾ˆå¯èƒ½æ˜¯ä¸åŒçš„ã€‚
    ![OpenWrt snapshots trunk](img/2.8.snapshots-trunk.png)

3.  TP-LINK WR2543 è·¯ç”±å™¨çš„ Flash ç±»å‹ä¸º genericï¼Œäºæ˜¯è¿›å…¥äº† [`downloads.openwrt.org/snapshots/trunk/ar71xx/generic/`](http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/)

4.  æŒ‰ Ctrl+F æŸ¥æ‰¾è‡ªå·±çš„è·¯ç”±å™¨å‹å·ã€‚æ¯”å¦‚æˆ‘è¾“å…¥çš„æ˜¯ **wr2543**, æœ‰ä¸¤ä¸ªå›ºä»¶ï¼Œå‡çº§ç”¨çš„æ˜¯ **sysupgrade.bin**æ–‡ä»¶ã€‚å³é”®ç‚¹å‡»è¯¥é“¾æ¥ï¼Œå¤åˆ¶ä¸‹è½½åœ°å€ã€‚åœ¨ FireFox é‡Œæ˜¯ **Copy Link Location**å¤åˆ¶é“¾æ¥åœ°å€ã€‚

5.  å›åˆ° Ubuntu å‘½ä»¤è¡Œç»ˆç«¯ï¼Œ ä¸‹è½½å›ºä»¶åˆ° **/tmp** ç›®å½•ã€‚TP-LINK wr2543 è·¯ç”±å™¨æ˜¯è¿™æ ·çš„:

    ```
     root@OpenWrt:/tmp# wget http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin 
    ```

## md5 æ ¡éªŒï¼Œç¡®ä¿ä¸‹è½½çš„å›ºä»¶å®Œæ•´:

```
 root@OpenWrt:/tmp# wget http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/md5sums  
    root@OpenWrt:/tmp# md5sum -c md5sums 2> /dev/null | grep OK  
    openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin: OK 
```

è¾“å‡ºç»“å°¾æ˜¯ OKï¼Œè¯´æ˜å›ºä»¶æ˜¯å®Œæ•´çš„ã€‚

## OpenWrt sysupgrade å‘½ä»¤å‡çº§ OpenWrt å›ºä»¶

```
 root@OpenWrt:/tmp# sysupgrade -v openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin 
    ... 
    Upgrade completed
    Rebooting system... 
```

è¿‡çº¦ 2 åˆ†é’Ÿï¼Œç­‰è·¯ç”±å™¨é‡å¯æˆåŠŸï¼Œå¦‚æœæ²¡æœ‰æ„å¤–ï¼Œä¼šå‘ç°æœ‰çº¿å’Œæ— çº¿ä¸Šç½‘éƒ½æ­£å¸¸ã€‚ä½†æµè§ˆå™¨ 192.168.1.1 æ— æ³•ç™»å½•ï¼Œå› ä¸º snapshots ç‰ˆæœ¬å›ºä»¶æ˜¯ä¸å¸¦ LuCI ç½‘é¡µç®¡ç†ç•Œé¢çš„ã€‚æ²¡æœ‰ä¹Ÿå¥½ï¼Œå¯ä»¥èŠ‚çœè·¯ç”±å™¨çš„å­˜å‚¨ç©ºé—´ï¼Œä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹å‘½ä»¤è¡Œç®¡ç† OpenWrt è·¯ç”±å™¨ã€‚

#### å‚è€ƒï¼š

*   [generic.sysupgrade](http://wiki.openwrt.org/doc/howto/generic.sysupgrade)
*   [sysupgrade source code](https://dev.openwrt.org/browser/trunk/package/base-files/files/sbin/sysupgrade)
*   [sysupgrade doc](http://wiki.openwrt.org/doc/techref/sysupgrade)

# å‘½ä»¤è¡Œ uci è®¾ç½® OpenWrt ä¸Šç½‘å‚æ•°

å¦‚æœè·¯ç”±å™¨å¯ä»¥æ­£å¸¸ä¸Šç½‘çš„å‰æï¼Œæˆ‘ä»¬å¯ä»¥ ssh ç™»å½•è·¯ç”±å™¨ï¼Œç›´æ¥åœ¨è·¯ç”±å™¨çš„/tmp ç›®å½• wget ä¸‹è½½æœ€æ–°ç‰ˆå›ºä»¶å¹¶ sysupgrade å‘½ä»¤è¿›è¡Œå›ºä»¶å‡çº§ã€‚

æœ‰æ—¶å€™ï¼Œè·¯ç”±å™¨æ— æ³•ä¸Šç½‘ï¼Œè¿™æ—¶å€™ï¼Œå¯ä»¥åœ¨ç”µè„‘é‡Œä¸‹è½½å¥½å›ºä»¶ï¼Œå†æŠŠå›ºä»¶å¤åˆ¶åˆ°è·¯ç”±å™¨ï¼Œå† sysupgrade å‡çº§æˆ–è®¾ç½®å…¶ä»–å‚æ•°ã€‚

åªè¦èƒ½è¿›å…¥è·¯ç”±å™¨çš„å®‰å…¨æ¨¡å¼ï¼Œå¹¶ ssh ç™»å½•è·¯ç”±å™¨ï¼Œä¸€åˆ‡éƒ½ä¸æ˜¯é—®é¢˜ã€‚

## Ubuntu ä¸‹è½½ OpenWrt for TP-LINK wr2543N trunk ç‰ˆå›ºä»¶

```
cd ~/Downloads
wget http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin 
```

## scp å¤åˆ¶å›ºä»¶åˆ° OpenWrt è·¯ç”±å™¨ /tmp ç›®å½•

```
scp openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin root@192.168.1.1:/tmp/ 
```

## ssh ç™»å½• OpenWrt è·¯ç”±å™¨

```
ssh root@192.168.1.1
cd /tmp 
```

## sysupgrade å‡çº§å›ºä»¶å¹¶å–æ¶ˆä¿ç•™åŸæ¥é…ç½®æ–‡ä»¶

æ³¨æ„ï¼Œå‡çº§åå°†æ— æ³•ä¸Šç½‘ï¼Œä¹Ÿæ²¡æœ‰ LuCI ç½‘é¡µç•Œé¢å¯ä»¥è®¾ç½®ï¼Œå¿…é¡»ä»¥å‘½ä»¤è¡Œæ–¹å¼è®¾ç½®å¥½ä¸Šç½‘å‚æ•°ã€‚

å¦‚æœåœ¨ä¸‹é¢çš„å®éªŒä¸­ï¼Œå‘½ä»¤è¡Œæ–¹å¼æ— æ³•æå®šè·¯ç”±å™¨ä¸Šç½‘ï¼Œå°±åªèƒ½åœ¨ç”µè„‘é‡Œä¸‹è½½å¥½å¸¦ luCI çš„å›ºä»¶ï¼Œscp å¤åˆ¶å›ºä»¶åˆ°è·¯ç”±å™¨å‡çº§å›ºä»¶ï¼Œç„¶åä»¥ç½‘é¡µæ–¹å¼è®¾ç½®ä¸Šç½‘ã€‚

åœ¨è¿›è¡Œè¿™ä¸€æ­¥å‰ï¼Œç¡®ä¿ä½ ç†Ÿç»ƒæŒæ¡ä»¥å‰éƒ¨åˆ†æ•™ç¨‹ã€‚

```
root@OpenWrt:/tmp# sysupgrade -n openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-sysupgrade.bin 
```

å‚æ•° `-n` è¡¨ç¤ºå‡çº§æ—¶ä¸ä¿ç•™åŸæ¥çš„é…ç½®æ–‡ä»¶ã€‚å›ºä»¶åˆ·å¥½åä¼šè‡ªåŠ¨é‡å¯ï¼Œè¿™æ—¶è¦ç”¨å‰æ–‡æ•™ç¨‹è®²è¿‡çš„æ–¹æ³•è¿›å…¥ OpenWrt å®‰å…¨æ¨¡å¼ï¼Œç™»å½•è·¯ç”±å™¨å¹¶é‡æ–°è®¾ç½® root å¯†ç ã€‚

ä¸‹é¢å‡è®¾ä½ å·²ç»ç™»å½•äº†è·¯ç”±å™¨å¹¶è®¾å¥½äº† root å¯†ç ã€‚

## OpenWrt uci å‘½ä»¤è¡Œè®¾ç½®æ‹¨å·ä¸Šç½‘ï¼š

```
root@OpenWrt: uci set network.wan.proto='pppoe'
root@OpenWrt: uci set network.wan.username='wan-username'
root@OpenWrt: uci set network.wan.password='wan-password'
root@OpenWrt: uci set network.wan.peerdns=0 
```

wan-username æ›¿æ¢æˆä½ è‡ªå·±çš„æ‹¨å·ä¸Šç½‘ç”¨æˆ·åï¼Œwan-password æ›¿æ¢æˆä½ è‡ªå·±çš„å¯†ç ã€‚

## OpenWrt uci å‘½ä»¤è¡Œè®¾ç½®æ— çº¿ä¸Šç½‘ï¼š

```
root@OpenWrt: uci set wireless.@wifi-device[0].channel=11
root@OpenWrt: uci set wireless.@wifi-device[0].txpower=17
root@OpenWrt: uci set wireless.@wifi-device[0].disabled=0
root@OpenWrt: uci set wireless.@wifi-device[0].country='CN'
root@OpenWrt: uci set wireless.@wifi-iface[0].mode='ap'
root@OpenWrt: uci set wireless.@wifi-iface[0].ssid='eastking-tlwr2543'
root@OpenWrt: uci set wireless.@wifi-iface[0].encryption='psk2'
root@OpenWrt: uci set wireless.@wifi-iface[0].key='icanfly9876' 
```

### uci è®¾ç½®è¯´æ˜ï¼š

*   channel ä¿¡é“
*   txpower åŠŸç‡
*   disabled æ˜¯å¦å¯ç”¨æ— çº¿ï¼Œ0 è¡¨ç¤ºå¯ç”¨
*   ssid åç§°ï¼Œæ¨èåé¢ä»¥è·¯ç”±å™¨å‹å·ç»“å°¾ï¼Œè¿™æ ·è°ƒè¯•å¤šä¸ªè·¯ç”±å™¨æ—¶ä¸ä¼šæ··æ·†ã€‚
*   encryption åŠ å¯†æ–¹å¼
*   key æ— çº¿å¯†ç ï¼Œå¦‚æœä½ ç…§ä¸Šæ–‡çš„è®¾ç½®ä¸åŠ¨ï¼Œå¥½å¤„æ˜¯å¿˜è®°å¯†ç æ—¶å¯ä»¥ä¸Š [`www.github.com/softwaredownload/openwrt-fanqiang`](http://www.github.com/softwaredownload/openwrt-fanqiang) æ¥æŸ¥çœ‹ã€‚

## å…è®¸è¿œç¨‹ä¸»æœºç”¨ ssh çš„æ–¹å¼ç™»å½•è·¯ç”±å™¨åŠè®¾ç½®æ—¶åŒº

```
root@OpenWrt: uci set dropbear.@dropbear[0].GatewayPorts='on'
root@OpenWrt: uci set system.@system[0].zonename='Asia/Shanghai'
root@OpenWrt: uci set system.@system[0].timezone='CST-8' 
```

## ssh ç™»å½• OpenWrt ç›¸å…³é«˜çº§è®¾ç½®ï¼ˆä½ å¯èƒ½æš‚æ—¶ç”¨ä¸åˆ°)

```
root@OpenWrt: uci set dropbear.@dropbear[0].Port=22
root@OpenWrt: uci set dropbear.@dropbear[0].PasswordAuth=off
root@OpenWrt: uci set dropbear.@dropbear[0].RootPasswordAuth=off 
```

### è¯´æ˜ï¼ˆä¸æ‡‚åƒä¸‡åˆ«ä¹±è®¾ï¼‰ï¼š

*   Port ssh é»˜è®¤ç«¯å£å°±æ˜¯ 22,å¯ä»¥æ”¹æˆå…¶ä»–çš„æé«˜å®‰å…¨æ€§
*   PasswordAuth ssh æ˜¯å¦å¯ç”¨å¯†é’¥ç™»å½•ã€‚å¦‚æœä½ æ”¹æˆ offï¼Œåˆæ²¡æœ‰è®¾ç½®å¥½ ssh ç§é’¥å’Œå®‰è£…å¥½ LuCIï¼Œä½ å°†æ— æ³• ssh æ–¹å¼ç™»å½•è·¯ç”±å™¨ï¼Œå”¯ä¸€çš„åŠæ³•å°±æ˜¯å®‰å…¨æ¢å¤æ¨¡å¼ç™»å½•é‡æ–°å¼€å§‹è®¾ç½®ã€‚
*   RootPasswordAuth æ˜¯å¦å…è®¸ root ç”¨å¯†ç ç™»å½•ï¼Œå¦‚æœå·²ç»è®¾ç½®å¥½äº† ssh ç§é’¥å°±å¯ä»¥æ”¹æˆ off å¢åŠ å®‰å…¨æ€§ã€‚

## å¯ç”¨æ–°çš„ç½‘ç»œå’Œæ— çº¿è®¾ç½®

```
root@OpenWrt: /etc/init.d/dropbear restart
root@OpenWrt: /etc/init.d/system restart
root@OpenWrt: /etc/init.d/network restart 
```

æ€ä¹ˆæ ·ï¼Œæœ‰çº¿å’Œæ— çº¿ä¸Šç½‘åˆéƒ½å›æ¥äº†å§ï¼

æ³¨æ„ï¼Œæœ‰çš„äººåœ¨ç½‘ä¸Šè´´å‡ºäº†ä»–çš„å®Œæ•´é…ç½®æ–‡ä»¶/etc/config/network å’Œ/etc/config/wirelessï¼Œã€€å¦‚æœä½ å¤åˆ¶ä»–çš„æ–‡ä»¶è¦†ç›–ä½ çš„æ–‡ä»¶ï¼Œå†ä¿®æ”¹ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯èƒ½ä¼šå‡ºé—®é¢˜ï¼Œå› ä¸ºä¸åŒè·¯ç”±å™¨çš„ç¡¬ä»¶é…ç½®å¯èƒ½ä¸åŒã€‚

# è®© openwrt èƒ½æ­£å¸¸å®‰è£…è½¯ä»¶

# ç»™åˆå§‹ä¸å…·å¤‡ğŸªœğŸ§±èƒ½åŠ›çš„è·¯ç”±å™¨é…ç½®è½¯ä»¶æº

å½“æˆ‘ä»¬åˆšç»™è·¯ç”±å™¨åˆ·ä¸Š OPENWRT åï¼Œå…¶åªå…·å¤‡åŸºæœ¬çš„ä¸Šç½‘åŠŸèƒ½ã€‚ è¿™é‡Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨ opkg update å®‰è£…è½¯ä»¶æ—¶ï¼Œå‘ç°å…¶æ ¹æœ¬ä¸èƒ½ update,å› ä¸ºå®ƒè¦è¿æ¥çš„ download.operwrt.org æœ¬èº«ä¹Ÿåœ¨è¢«ğŸ§±åˆ—è¡¨ä¸­ã€‚ï¼ˆæˆ–æœªè¢«ğŸ§±ï¼Œä½†é€Ÿåº¦å¥‡æ…¢ã€‚ï¼‰

æ–¹æ³•æœ‰å‡ ç§

## æ–¹æ³• 1ï¼Œä¸º opkg é…ç½®ä»£ç†

1.  åœ¨è·¯ç”±é…ç½®æ–‡ä»¶ä¸­ï¼Œä¸º openwrt çš„ opkg é…ç½®ä»£ç†ã€‚ [æ¥æº openwrt wiki](https://wiki.openwrt.org/zh-cn/doc/techref/opkg)

    è¿›å…¥è·¯ç”±å™¨èœå•ï¼Œé€‰æ‹©ç³»ç»Ÿ-è½¯ä»¶ï¼Œç‚¹å‡»â€œé…ç½®â€é¡µç­¾ï¼Œè¾“å…¥ï¼š

    option http_proxy [`proxy.example.org:8080/`](http://proxy.example.org:8080/)

    option ftp_proxy ftp://proxy.example.org:2121/

2.  ä¹Ÿå¯ä»¥ç›´æ¥ vi /etc/opkg.conf å»ä¿®æ”¹ã€‚

    option http_proxy [`proxy.example.org:8080/`](http://proxy.example.org:8080/)

    option ftp_proxy ftp://proxy.example.org:2121/

## æ–¹æ³• 2ï¼Œ æ¶è®¾ä¸€ä¸ªä¸éœ€ä»£ç†å°±å¯è®¿é—®çš„è½¯ä»¶æºã€‚

1.  å»ºç«‹ OPENWRT çš„é•œè±¡æ–‡ä»¶ã€‚

    åˆ°

    [`downloads.openwrt.org`](https://downloads.openwrt.org)

    ä¸‹è½½ä½ æ‰€éœ€è¦çš„èŠ¯ç‰‡å¯¹åº”çš„æ–‡ä»¶å¤¹å†…çš„ç›®å½•åŠæ–‡ä»¶æ‹–åˆ°æœ¬åœ°ã€‚ æ¯”å¦‚æˆ‘çš„æ˜¯ï¼šar71xx/nand/packages/ ä¸‹çš„ base luci management ç­‰æ–‡ä»¶å¤¹ã€‚ä½¿ç”¨ wget å‘½ä»¤å¯ä»¥æ•´ç«™æ‹–ã€‚

    `wget -m -np https://downloads.openwrt.org/chaos_calmer/15.05/ar71xx/nand/packages/`

    å¦‚æœæ˜¯æ—§ç‰ˆçš„è·¯ç”±ï¼Œè¯·è‡ªè¡Œåˆ°æ‰¾åˆ°å¯¹åº”çš„ç‰ˆæœ¬å»ä¸‹è½½ï¼Œæ¯”å¦‚

    `wget -m -np https://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/nand/packages/`

2.  ä½¿ç”¨ä»»ä¸€å»ºç«™è½¯ä»¶ï¼Œæ¯”å¦‚ Nignx å»ºç«‹ç®€å•çš„ http æœåŠ¡å™¨.

3.  å°† opkg-config å†…çš„è½¯ä»¶æºæ”¹æˆè‡ªå·±çš„ http æœåŠ¡å™¨

    ```
     - src/gz chaos_calmer_base http://192.168.1.121:8008/base

     - src/gz chaos_calmer_luci http://192.168.1.121:8008/luci

     - src/gz chaos_calmer_packages http://192.168.1.121:8008/packages

     - src/gz chaos_calmer_routing http://192.168.1.121:8008/routing

     - src/gz chaos_calmer_telephony http://192.168.1.121:8008/telephony

     - src/gz chaos_calmer_management http://192.168.1.121:8008/management 
    ```

Done.